!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.unsync=b()}(this,function(){"use strict";function a(b,c){if("function"!=typeof b)throw new Error("Expected function, got "+typeof b);var d=a.createBlobTemplate(b.toString()),e=a.createWorker(d),f=a.createAsyncFunction(e,Boolean(c));return f}var b=Function.prototype.call.bind(Array.prototype.slice),c=window.URL||window.webkitURL;return Object.defineProperty(a,"supported",{enumerable:!0,get:function(){return"function"==typeof window.Worker&&"function"==typeof c&&"function"==typeof c.createObjectURL&&function(){try{a.createWorker(";")}catch(b){return!1}return!0}()}}),a.template="this.onmessage = function(evt){  var result = (#CODE#).apply(null, evt.data);  this.postMessage(result);};",a.createBlobTemplate=function(a){return this.template.split("#CODE#").join(a)},a.createWorker=function(a){var b=new Blob([a],{type:"text/javascript"}),d=c.createObjectURL(b),e=new Worker(d);return c.revokeObjectURL(d),e},a.createMessageHandler=function(a,b,c){return function d(e){this.removeEventListener("message",d),c&&a.terminate(),b&&b.call(null,e.data,a)}},a.createAsyncFunction=function(c,d){var e=!1,f=function g(){if(e)throw new Error("Background process already terminated");var f=arguments.length>0?arguments[arguments.length-1]:null,h=arguments.length>1?b(arguments,0,-1):[];c.postMessage(h),c.addEventListener("message",a.createMessageHandler(g,f,d),!1)};return Object.defineProperties(f,{isTerminated:{enumerable:!0,get:function(){return e}},terminate:{enumerable:!0,value:function(){c.terminate(),e=!0}}}),f},a});