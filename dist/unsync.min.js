!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.unsync=b()}(this,function(){"use strict";function a(b,c){if("function"!=typeof b)throw new Error("Expected function, got "+typeof b);var d=a.createBlobTemplate(b.toString()),e=a.createWorker(d),f=a.createAsyncFunction(e,Boolean(c));return f}var b=Function.prototype.call.bind(Array.prototype.slice),c=window.URL||window.webkitURL;return Object.defineProperty(a,"supported",{enumerable:!0,get:function(){return"function"==typeof window.Worker&&"function"==typeof c&&"function"==typeof c.createObjectURL&&function(){try{a.createWorker(";")}catch(b){return!1}return!0}()}}),a.template="this.onmessage = function(evt){  var result = (#CODE#).apply(null, evt.data);  this.postMessage(result);};",a.createBlobTemplate=function(a){return this.template.split("#CODE#").join(a)},a.createWorker=function(a){var b=new Blob([a],{type:"text/javascript"}),d=c.createObjectURL(b),e=new Worker(d);return c.revokeObjectURL(d),e},a.createAsyncFunction=function(a,c){var d=!1,e=function f(){if(d)throw new Error("Background process already terminated");var e=arguments.length>0?arguments[arguments.length-1]:null,g=arguments.length>1?b(arguments,0,-1):[];a.postMessage(g),a.addEventListener("message",function h(b){a.removeEventListener("message",h),c&&f.terminate(),e&&e.call(null,b.data,f)},!1)};return Object.defineProperties(e,{isTerminated:{enumerable:!0,get:function(){return d}},terminate:{enumerable:!0,value:function(){a.terminate(),d=!0}}}),e},a});